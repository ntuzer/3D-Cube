var RubiksCube=RubiksCube||{};RubiksCube=function(){"use_strict";var e,t,n=cubeData.globalCubeState,a=cubeData.cubes,r=cubeData.globalFaceState,o=cubeData.xyzState,i=(cubeData.edgeMap,cubeData.edgePolarity),c=cubeData.edgeToGlobalFace,u=cubeData.movements,s=cubeData.facements,d=cubeData.movementPolarity,m=cubeData.faceToMovement,l=cubeData.globalFaceToCube,b=(cubeData.cubeToFace,cubeData.cubeMovementToDirection),f=cubeData.centerState,v=cubeData.centerMappingByMovement,g=(cubeData.centerPolarity,cubeData.movementToCubes),E=cubeData.direction,y=!1,h=new THREE.Vector2,w=new THREE.Vector3(0,0,1),T=new THREE.Vector3(0,0,1),x=new THREE.Raycaster,p=window.innerWidth/2,D=window.innerHeight/2,z=5,k=new Date,C=50,H={x:0,y:0},M=0,R=0;function S(n){n.preventDefault(),h.x=(n.clientX-renderer.domElement.offsetLeft)/renderer.domElement.clientWidth*2-1,h.y=-(n.clientY-renderer.domElement.offsetTop)/renderer.domElement.clientHeight*2+1,new THREE.Vector3(h.x,h.y,0).unproject(e),x.setFromCamera(h,e);var a,o,i,c=x.intersectObjects(t.children);if(0===c.length)return null;if(c.length>0)for(var u=0;u<c.length;u++)if(c[u].face.materialIndex>0){a=c[u].faceIndex;break}var s=Object.keys(r);for(u=0;u<s.length;u++)if(r[s[u]]===a){o=s[u];break}i=m[o],l[o],99!==i&&F(i)}function F(e){var t;(t=e)<=6?j(t,"x"):t<=12?j(t,"y"):t<=17&&j(t,"z"),function(e){var t={},a=Object.keys(e);Object.keys(n).forEach(function(e){t[e]=n[e]});for(var r=0;r<a.length;r++)t[a[r]]=n[e[a[r]]];n=t}(u[e]),function(e){var t={},n=Object.keys(e);Object.keys(r).forEach(function(e){t[e]=r[e]});for(var a=0;a<n.length;a++)t[n[a]]=r[e[n[a]]];r=t}(s[e]),function(e){var t,n={};Object.keys(f).forEach(function(e){n[e]=f[e]}),t=g[e];for(var a=0;a<t.length;a++){for(var r=t[a],o=b[r][e][1],i={},c=(f[r],f[o],v[o][e]),u=Object.keys(c),s=0;s<u.length;s++){var d=u[s],m=c[d];i[m]=f[o][d]}n[r]=i}f=n}(e)}function j(e,t){for(var a=u[e],r=Object.keys(a),o=0;o<9;o++)B(n[r[o]],r[o],t,e)}function B(e,t,a,u){var s,m,l,v,g,y,h,w,T,x,p=E[u],D=o[e.uuid],z=D.x,k=D.y,C=D.z;n[t];switch(l=d[u],a){case"x":g=z;break;case"y":g=k;break;case"z":g=C}"xp"===g?(p<0&&(p*=-1),e.rotateX(p)):"xn"===g?(p>0&&(p*=-1),e.rotateX(p)):"yp"===g?(p<0&&(p*=-1),e.rotateY(p)):"yn"===g?(p>0&&(p*=-1),e.rotateY(p)):"zp"===g?(p<0&&(p*=-1),e.rotateZ(p)):"zn"===g?(p>0&&(p*=-1),e.rotateZ(p)):"xc"===g?(v=b[t][u][0],f[t][v]!==l&&(p*=-1),e.rotateX(p)):"yc"===g?(v=b[t][u][0],f[t][v]!==l&&(p*=-1),e.rotateY(p)):"zc"===g?(v=b[t][u][0],f[t][v]!==l&&(p*=-1),e.rotateZ(p)):"x"===g[0]?(m=c[u][t],s=r[m],l!==i[s]&&(p*=-1),e.rotateX(p)):"y"===g[0]?(m=c[u][t],s=r[m],l!==i[s]&&(p*=-1),e.rotateY(p)):"z"===g[0]&&(m=c[u][t],s=r[m],l!==i[s]&&(p*=-1),e.rotateZ(p)),y=e,w=z,T=k,x=C,"x"===(h=a)[0]?(o[y.uuid].x=w,o[y.uuid].y=x,o[y.uuid].z=T):"y"===h[0]?(o[y.uuid].x=x,o[y.uuid].y=T,o[y.uuid].z=w):"z"===h[0]&&(o[y.uuid].x=T,o[y.uuid].y=w,o[y.uuid].z=x)}function O(){p=window.innerWidth/2,D=window.innerHeight/2,e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function L(e){e.preventDefault(),document.getElementsByTagName("canvas")[0].addEventListener("mousemove",N,!1),document.getElementsByTagName("canvas")[0].addEventListener("mouseup",P,!1),y=!0,H={x:e.clientX,y:e.clientY},w=T=V(0,0)}function N(e){var t,n;t=e.x,n=e.y,M=(t-H.x)/2,R=(n-H.y)/2,X(),H.x=t,H.y=n,k=new Date}function P(e){(new Date).getTime()-k.getTime()>C&&(M=e.x-H.x,R=e.y-H.y),y=!1,document.getElementsByTagName("canvas")[0].removeEventListener("mousemove",N,!1),document.getElementsByTagName("canvas")[0].removeEventListener("mouseup",P,!1)}function V(e,t){var n=new THREE.Vector3;n.set(W(e/p,-1,1),W(-t/D,-1,1),0);var a=n.length();return a>1?n.normalize():n.z=Math.sqrt(1-a*a),n}function W(e,t,n){return Math.min(Math.max(e,t),n)}function q(){requestAnimationFrame(q),function(){if(!y){M<-.05||M>.05?M*=.95:M=0,R<-.05||R>.05?R*=.95:R=0,X()}renderer.render(t,e)}()}function X(){T=V(M,R);var e=function(e,t){axis=new THREE.Vector3,quaternion=new THREE.Quaternion;var n=Math.acos(e.dot(t)/e.length()/t.length());return n&&(axis.crossVectors(e,t).normalize(),n*=z,quaternion.setFromAxisAngle(axis,n)),quaternion}(w,T);a.forEach(function(t){var n=t.quaternion;n.multiplyQuaternions(e,n),n.normalize(),t.setRotationFromQuaternion(n)}),T=w}function Y(e,t,n){switch(t=t||0,n=n||0,e){case"up":M=0,R=-6.25;break;case"down":M=0,R=6.25;break;case"left":M=-6.733333333333333,R=0;break;case"right":M=6.733333333333333,R=0;break;default:M=t,R=n}X()}function A(){(function(){var e=[1,3,4,6,7,9,10,12,14,15,16,17],t=[],n=0;for(;n<30;){var a=Math.floor(12*Math.random()),r=Math.round(Math.random());t.push(e[a]),r&&(t.push(e[a]),t.push(e[a])),n++}return t})().forEach(function(e){F(e)})}return{init:function(){!function(){(e=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,1e3)).position.y=0,e.position.z=500,t=new THREE.Scene;var n=new THREE.Color(9813963);t.background=n;for(var r=0;r<27;r++)t.add(a[r]);renderer=new THREE.CanvasRenderer,renderer.setClearColor(16777215),renderer.setSize(window.innerWidth,window.innerHeight),document.getElementById("rubiksCube").appendChild(renderer.domElement),document.getElementsByTagName("canvas")[0].addEventListener("mousedown",L,!1),document.getElementsByTagName("canvas")[0].addEventListener("contextmenu",S,!1),window.addEventListener("resize",O,!1),q()}()},setRotationSpeed:function(e){var t=e.srcElement.valueAsNumber;(t=t||5)>30&&(t=30),z=t},setCubeSize:function(e){var t=e.srcElement.valueAsNumber;(t=t||1)>20&&(t=20),z=t},scramble:function(e){A()},reset:function(){for(var e=0;e<27;e++)t.remove(a[e]);var y;y=new CubeData,n=y.globalCubeState,a=y.cubes,r=y.globalFaceState,o=y.xyzState,y.edgeMap,i=y.edgePolarity,c=y.edgeToGlobalFace,u=y.movements,s=y.facements,d=y.movementPolarity,m=y.faceToMovement,l=y.globalFaceToCube,y.cubeToFace,b=y.cubeMovementToDirection,f=y.centerState,v=y.centerMappingByMovement,y.centerPolarity,g=y.movementToCubes,E=y.direction;for(e=0;e<27;e++)t.add(a[e]);Y("left")},manual:Y}}();